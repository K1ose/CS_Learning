---
title: CVE-2021-3156
top: false
comment: false
lang: zh-CN
date: 2021-11-26 23:08:42
tags:
categories:
  - CTF
  -	PWN
  - user space pwn
  - cve
---

# CVE-2021-3156 字符串转义的堆溢出

## 环境

### sudo版本

```
all legacy versions from 1.8.2 to 1.8.31p2
all stable versions from 1.9.0 to 1.9.5p1
```

[这里用的是1.9.5p1](https://github.com/sudo-project/sudo/archive/SUDO_1_9_5p1.tar.gz)

### ubuntu环境

```
ubuntu-20.10
```

## 简介

[官方的文章](https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt)

```
This vulnerability:
- is exploitable by any local user (normal users and system users,
  sudoers and non-sudoers), without authentication (i.e., the attacker
  does not need to know the user's password);

We developed three different exploits for this vulnerability, and
obtained full root privileges on Ubuntu 20.04 (Sudo 1.8.31), Debian 10
(Sudo 1.8.27), and Fedora 33 (Sudo 1.9.2). Other operating systems and
distributions are probably also exploitable
```

