---
title: router-vuln-web
top: false
comment: false
lang: zh-CN
date: 2021-12-16 13:55:18
tags:
categories:
  - study
  - book
  - 揭秘家用路由器0day漏洞挖掘技术
---

# 路由器Web漏洞

家用路由器通常都有web管理服务，可以通过管理界面去配置路由器，而这也导致了路由器遭受类似于网站的攻击。

## XSS漏洞

跨站脚本攻击，Cross Site Scripting，入侵者在远程Web页面的HTML代码中插入具有恶意目的的数据，当浏览器载入该页面时，插入其中的脚本被解释执行。

### 路由器相关

假设路由器管理网页中包含一个反射型XSS，可以构件一个利用这个XSS漏洞的URL，将其通过邮件或QQ消息发送给受害者，引诱受害者点击这个URL，从而访问路由器网页。访问路由器网页后，恶意代码在浏览器中执行，会将路由器网页的会话Cookie发送给攻击者，导致不知情的情况下泄露了路由器Cookie，从而攻击者可以获得路由器访问权限。

## CSRF

跨站请求伪造，Cross-Site Request Forgery，是一种对网站的恶意利用。通过伪装来自受信任用户的请求达到利用受信任的网站的目的。

### 路由器相关

只要存在网页，就可能实现CSRF，其能够直接修改路由器参数；

共接着构造一个针对路由器的CSRF链接，欺骗受害者点击该链接，其功能是修改路由器iDNS为一个伪造的DNS服务器，这样，受害者访问正常网页时，因为DNS劫持而降所有网络访问数据发送给攻击者，攻击者可以监控受害者的所有网络访问行为；

## 认证

早期的IE和现在的Chrome、Firefox都可以使用一种比较特殊的URL访问方法实现路由器认证，如http://admin:admin@192.168.0.1，这种方法只要知道用户名和密码就可以不用手工输入用户名和密码完成路由器的直接认证；

由此可以伪造方法：

```
<img src="http://admin:admin@192.168.0.1">
```

或者用`<iframe>、</iframe>`来隐藏

```
<iframe src=http://admin:admin@192.168.0.1 width=0 height=0 frameborder=0>
</iframe>
```

当用户点击超链接、浏览器自动请求资源，即自动访问了该src内容；

### 路由器相关

XSS和CSRF都需要受害者登陆路由器，而如果受害者没有登陆，那么即使XS和CSRF攻击成立，也无法修改路由器配置（固有权限），利用基础认证的漏洞，可以使未登录状态瞬间变为已登陆装填，从而结合XSS或CSRF对路由进行进一步攻击；
